pingora:
  version: 1
  threads: 8
  pid_file: /run/pingora.pid
  upgrade_sock: /tmp/pingora_upgrade.sock
  user: nobody
  group: webusers

listeners:
  - address: 0.0.0.0:8080
routers:
  - id: web
    uris:
      - /api.{*p}
      - /files/
    upstream_id: grpc
  - id: photo
    uri: /storage/
    upstream_id: preview


upstreams:
  - id: grpc
    nodes:
      "127.0.0.1:8083": 1
    type: roundrobin
    scheme: http
  - id: preview
    nodes:
      "54.37.83.181:8081": 1
    type: roundrobin
    scheme: http

global_rules:
  - id: global
    plugins:
      logger: {}
